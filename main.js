!function(){"use strict";const e=(e,n,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?t(n,o):r(n,o)},t=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},r=(e,t)=>{e.disabled=!1,e.classList.remove(t.inactiveButtonClass)};(t=>{document.querySelectorAll(t.formSelector).forEach((r=>{((t,r)=>{const n=Array.from(t.querySelectorAll(r.inputSelector)),o=t.querySelector(r.submitButtonSelector);e(n,o,r),n.forEach((a=>{a.addEventListener("input",(function(){var s,l,i;s=t,i=r,(l=a).validity.valid?((e,t,r)=>{const n=t.id+"-error",o=e.querySelector("#"+n);o.textContent="",o.classList.remove(r.errorClass),t.classList.remove(r.inputErrorClass)})(s,l,i):((e,t,r,n)=>{const o=t.id+"-error",a=e.querySelector("#"+o);a.textContent=r,a.classList.add(n.errorClass),t.classList.add(n.inputErrorClass)})(s,l,l.validationMessage,i),e(n,o,r)}))})),t.addEventListener("submit",(e=>{e.preventDefault()}))})(r,t)}))})({formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"});const n=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch("${this._baseUrl}/users/me",{headers:this._headers}).then((e=>{if(!e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getAppInfo(){return Promise.all([this.getUserInfo().then((e=>(this._userId=e._id,e))),this.getInitialCards()])}getInitialCards(){return fetch("${this._baseUrl}/cards",{headers:this._headers}).then((e=>{if(!e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"273bfa6a-d4bd-41dc-8c86-3b8ffeccf837","Content-Type":"application/json"}});n.getAppInfo().then((e=>{let[t]=e;t.forEach((e=>{const t=C([e]);S.prepend(t)})),s.textContent=userData.name,l.textContent=userData.about,avatarImage.src=userData.avatar}));const o=document.querySelector(".profile__edit-btn"),a=document.querySelector(".profile__add-btn"),s=document.querySelector(".profile__name"),l=document.querySelector(".profile__description"),i=document.querySelector("#edit-modal"),c=i.querySelector(".modal__form"),d=i.querySelector(".modal__close-btn"),u=i.querySelector("#profile-name-input"),m=i.querySelector("#profile-description-input"),_=document.querySelector("#add-card-modal"),p=_.querySelector(".modal__form"),f=p.querySelector(".modal__submit-btn"),v=_.querySelector(".modal__close-btn"),y=document.querySelector("#card-template"),S=document.querySelector(".cards__list"),b=_.querySelector("#add-card-name-input"),h=_.querySelector("#add-card-link-input"),q=document.querySelector("#preview"),E=q.querySelector(".modal__image"),L=q.querySelector(".modal__caption");function C(e){const t=y.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,n.src=e.link,n.alt=e.name,n.addEventListener("click",(()=>{I(q),L.textContent=e.name,E.src=e.link,E.alt=e.name})),o.addEventListener("click",(()=>{o.classList.toggle("card__like-btn_liked")})),a.addEventListener("click",(()=>{t.remove()})),t}function k(e){"Escape"===e.key&&x(document.querySelector(".modal_opened"))}function g(e){e.target.classList.contains("modal_opened")&&x(e.target)}function I(e){e.classList.add("modal_opened"),document.addEventListener("keydown",k)}function x(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",k)}v.addEventListener("click",(()=>{x(_)})),q.querySelector(".modal__close-btn").addEventListener("click",(()=>{x(q)})),document.querySelectorAll(".modal").forEach((e=>e.addEventListener("mousedown",g))),o.addEventListener("click",(()=>{u.value=s.textContent,m.value=l.textContent,resetValidation(c,settings),I(i)})),d.addEventListener("click",(()=>{x(i)})),a.addEventListener("click",(()=>{I(_)})),c.addEventListener("submit",(function(e){e.preventDefault(),n.editUserInfo({name:name.Input.vaule,about:description.Input.vaule}).then((e=>{profileNameElement.textContent=e.name,profileDescriptionElement.textContent=e.about,x(i)})).catch((e=>{console.error(e)}))})),p.addEventListener("submit",(function(e){e.preventDefault();const t=C({name:b.value,link:h.value});S.prepend(t),p.reset(),disableButton(f,settings),x(_)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQ2IsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idG5cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsLmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JNc2dFTCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJRCk7XG4gIGVycm9yTXNnRUwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgZXJyb3JNc2dFTC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvckNsYXNzKTtcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBzZXR0aW5ncykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0lEID0gaW5wdXRFbC5pZCArIFwiLWVycm9yXCI7XG4gIGNvbnN0IGVycm9yTXNnRUwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xuICBlcnJvck1zZ0VMLnRleHRDb250ZW50ID0gXCJcIjtcbiAgZXJyb3JNc2dFTC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmVycm9yQ2xhc3MpO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PlxuICBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uLCBzZXR0aW5ncykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbiwgc2V0dGluZ3MpO1xuICB9IGVsc2Uge1xuICAgIGVuYWJsZUJ1dHRvbihidXR0b24sIHNldHRpbmdzKTtcbiAgfVxufTtcblxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b24sIGNvbmZpZykgPT4ge1xuICBidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b24uY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uLCBjb25maWcpID0+IHtcbiAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgc2V0dGluZ3MpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbCwgc2V0dGluZ3MpO1xuICB9KTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBzZXR0aW5ncykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChzZXR0aW5ncykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBzZXR0aW5ncyk7XG4gIH0pO1xufTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgdmFsaWRhdGlvbkNvbmZpZyB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIGJyaWRnZSBvdmVyIHRoZSB3YXRlclwiLFxuICAgIGxpbms6IFwiICBodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuXTtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMjczYmZhNmEtZDRiZC00MWRjLThjODYtM2I4ZmZlY2NmODM3XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuYXBpLmdldEFwcEluZm8oKS50aGVuKChbY2FyZHNdKSA9PiB7XG4gIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KFtpdGVtXSk7XG4gICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICB9KTtcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgYXZhdGFySW1hZ2Uuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xufSk7XG5cbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IGNhcmRNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVDbG9zZWRCdG4gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xuY29uc3QgZWRpdERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGNhcmRGb3JtID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBjYXJkU3VibWl0QnRuID0gY2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcbmNvbnN0IGNhcmRNb2RhbENsb3NlZEJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XG5jb25zdCBjYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlld1wiKTtcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlRUwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRUwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBjYXJkTmFtZUVMID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRUwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG4gIGNhcmROYW1lRUwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWFnZUVMLnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltYWdlRUwuYWx0ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2VFTC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICAgIHByZXZpZXdNb2RhbENhcHRpb25FTC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVMLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVMLmFsdCA9IGRhdGEubmFtZTtcbiAgfSk7XG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICB9KTtcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9KTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuY2FyZE1vZGFsQ2xvc2VkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcbn0pO1xuY29uc3QgcHJldmlld01vZGFsQ2xvc2VkQnRuID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbnByZXZpZXdNb2RhbENsb3NlZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XG59KTtcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XG5tb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheUNsaWNrKVxuKTtcbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZUtleShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGNsb3NlTW9kYWwob3BlbmVkTW9kYWwpO1xuICB9XG59XG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xpY2soZXZ0KSB7XG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn1cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXkpO1xufVxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXkpO1xufVxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBhcGkuZWRpdFVzZXJJbmZvKHtuYW1lOiAgbmFtZS5JbnB1dC52YXVsZSwgYWJvdXQ6IGRlc2NyaXB0aW9uLklucHV0LnZhdWxlfSlcbiAgLnRoZW4oKGRhdGEpID0+IHtcbiAgXG4gICBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH1cbiAgKTtcbiBcbn1cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBpbnB1dFZhbHVlcyA9IHsgbmFtZTogY2FyZE5hbWVJbnB1dC52YWx1ZSwgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSB9O1xuICBjb25zdCBjYXJkRWwgPSBnZXRDYXJkRWxlbWVudChpbnB1dFZhbHVlcyk7XG4gIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbCk7XG4gIGNhcmRGb3JtLnJlc2V0KCk7XG4gIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG59XG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgZWRpdERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XG4gIHJlc2V0VmFsaWRhdGlvbihlZGl0Rm9ybUVsZW1lbnQsIHNldHRpbmdzKTtcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XG59KTtcbmVkaXRQcm9maWxlQ2xvc2VkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcbn0pO1xuY2FyZE1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xufSk7XG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xuIiwiXHJcblxyXG5jbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCIke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgIH1cclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcclxuICAgICAgdGhpcy5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IHJlcy5faWQ7XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgfSksXHJcbiAgICAgIHRoaXMuZ2V0SW5pdGlhbENhcmRzKClcclxuICAgIF0pO1xyXG4gIH1cclxuICBcclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKFwiJHt0aGlzLl9iYXNlVXJsfS9jYXJkc1wiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gIHJlcy5qc29uKClcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcblxyXG4gXHJcblxyXG5cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIl0sIm5hbWVzIjpbInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uIiwic2V0dGluZ3MiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImVuYWJsZUJ1dHRvbiIsImNvbmZpZyIsImRpc2FibGVkIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInJlbW92ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvcm1TZWxlY3RvciIsImZvckVhY2giLCJmb3JtRWwiLCJzZXRFdmVudExpc3RlbmVycyIsImZvcm1FbGVtZW50IiwiQXJyYXkiLCJmcm9tIiwiaW5wdXRTZWxlY3RvciIsImJ1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbnB1dEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5IiwiaW5wdXRFbCIsImhpZGVJbnB1dEVycm9yIiwiZXJyb3JNc2dJRCIsImlkIiwiZXJyb3JNc2dFTCIsInRleHRDb250ZW50IiwiZXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJlbmFibGVWYWxpZGF0aW9uIiwiYXBpIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwidGhpcyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEFwcEluZm8iLCJhbGwiLCJfdXNlcklkIiwiX2lkIiwiZ2V0SW5pdGlhbENhcmRzIiwiZWRpdFVzZXJJbmZvIiwiX3JlZiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwiaXRlbSIsImNhcmRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkc0xpc3QiLCJwcmVwZW5kIiwicHJvZmlsZU5hbWUiLCJ1c2VyRGF0YSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImF2YXRhckltYWdlIiwic3JjIiwiYXZhdGFyIiwicHJvZmlsZUVkaXRCdXR0b24iLCJjYXJkTW9kYWxCdG4iLCJlZGl0TW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0UHJvZmlsZUNsb3NlZEJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXREZXNjcmlwdGlvbklucHV0IiwiY2FyZE1vZGFsIiwiY2FyZEZvcm0iLCJjYXJkU3VibWl0QnRuIiwiY2FyZE1vZGFsQ2xvc2VkQnRuIiwiY2FyZFRlbXBsYXRlIiwiY2FyZE5hbWVJbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxJbWFnZUVMIiwicHJldmlld01vZGFsQ2FwdGlvbkVMIiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVMIiwiY2FyZEltYWdlRUwiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJsaW5rIiwiYWx0Iiwib3Blbk1vZGFsIiwidG9nZ2xlIiwiaGFuZGxlRXNjYXBlS2V5IiwiZXZ0Iiwia2V5IiwiY2xvc2VNb2RhbCIsImhhbmRsZU92ZXJsYXlDbGljayIsInRhcmdldCIsImNvbnRhaW5zIiwibW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidmFsdWUiLCJyZXNldFZhbGlkYXRpb24iLCJJbnB1dCIsInZhdWxlIiwiZGVzY3JpcHRpb24iLCJwcm9maWxlTmFtZUVsZW1lbnQiLCJwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJjYXJkRWwiLCJyZXNldCJdLCJzb3VyY2VSb290IjoiIn0=